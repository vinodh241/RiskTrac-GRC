<div class="tab-content topTabContentBg h-9 mx-3">
  <div class="p-1 text-center position-relative h-100" id="nav-crisis-comm-fnc" role="tabpanel" style="z-index: 1;"
    aria-labelledby="nav-busitness-fnc">
    <div class="d-flex justify-content-right align-items-center vmiddleRight filterRight">
      <div class="applyFilter addDesktop position-relative text-start me-4 mb-1">
        <button type="button" class="btn btn-dark btnGradient" id="addCrisisMessage" *ngIf="service.isFBCCUser || service.isBCManager"
         (click)="addEditMessage('Add')">Create New Message</button>
        <span class="position-absolute vmiddleLeft text-white iconPositionLeft"><img
            src="./assets/images/icon-add-desktop.svg"></span>
      </div>
      <div class="d-inline-block position-relative searchInput me-2">
        <input placeholder="Search" class="form-control tblfilter" id="matInput" matInput (keyup)="applyFilter($event)">
        <span class="position-absolute vmiddleRight iconPositionRight"><i class="fa fa-search"
            aria-hidden="true"></i></span>
      </div>
    </div>
  </div>
</div>

<div class="table-model-bg h-80 px-3 w-100 py-4 vscroll">
  <div class="h-100 pb-3 w-100">
    <div class="row mx-0 h-100">
      <div class="col-12 px-0 h-100">
        <div class="cardGen colorGeyGradient w-100 h-100">
          <div class="cardBody singleRow w-100 h-100">
            <div class="w-100 h-100 px-2 py-3 position-relative">
              <div class="w-100 h-6 position-relative">
                <h2 class="h-100 text-start"><img src="./assets/images/icon-cc.svg" class="headingIcon longBox icokKPI"
                    alt="Crisis Communication"> Crisis Communication</h2>
              </div>
              <div class="w-100 h-94">
                <section class="w-100 vscroll tableContent h-100" tabindex="0" >
                  <table mat-table [dataSource]="service.TableCrisisComm" class="table-striped" id='crisi-comm-table'
                    matSort (matSortChange)="sortData($event)">

                    <ng-container matColumnDef="Index">
                      <th mat-header-cell *matHeaderCellDef class="w-4  text-center" style="border-right: 1px solid #fff;"> # </th>
                      <td mat-cell *matCellDef="let row" class="w-4" style="padding-left: 8px;text-align: center;">
                        {{row.Index}} </td>
                    </ng-container>

                    <ng-container matColumnDef="ComID">
                      <th mat-header-cell *matHeaderCellDef class="w-10" style="border-right: 1px solid #fff; padding-left: 8px;"> Com ID </th>
                      <td mat-cell *matCellDef="let row" class="w-10" style="padding-left: 8px;"> {{row.CommunicationID}} </td>
                    </ng-container>

                    <ng-container matColumnDef="Title">
                      <th mat-header-cell *matHeaderCellDef class="w-25" style="border-right: 1px solid #fff; padding-left: 8px;"> Title </th>
                      <td mat-cell *matCellDef="let row" class="w-25" style="padding-left: 8px; position: relative;"><a  [id]="'edit' + row.CommunicationID"
                          href="javascript: void(0);" class="tblLnk w-100" style="position: static;"
                          (click)="addEditMessage('Edit', row)">
                          <label class="texthorizontal-position" style="cursor: pointer;">
                            {{row.CommunicationTitle}}
                          </label></a>
                      </td>
                    </ng-container>

                    <ng-container matColumnDef="Category">
                      <th mat-header-cell mat-sort-header="CrisisCategory" *matHeaderCellDef class="w-8" style="border-right: 1px solid #fff; padding-left: 8px;"> Category </th>
                      <td mat-cell *matCellDef="let row" class="w-8" style="padding-left: 8px;">
                        {{row.CrisisCategory}} </td>
                    </ng-container>

                    <ng-container matColumnDef="Recipient">
                      <th mat-header-cell *matHeaderCellDef class="w-10" style="border-right: 1px solid #fff; padding-left: 8px;"> Recipient(s) </th>
                      <td mat-cell *matCellDef="let row" class="w-10" style="padding-left: 8px;">
                        {{row.RecipentOption}} </td>
                    </ng-container>

                    <ng-container matColumnDef="IssueDate">
                      <th mat-header-cell mat-sort-header="FormatedIssueDate" *matHeaderCellDef class="w-10" style="border-right: 1px solid #fff; padding-left: 8px;"> Issue Date </th>
                      <td mat-cell *matCellDef="let row" class="w-10" style="padding-left: 8px;">
                        {{row.FormatedIssueDate|date:'MMM d,y'}} </td>
                    </ng-container>

                    <ng-container matColumnDef="Attach">
                      <th mat-header-cell *matHeaderCellDef class="w-9 text-center" style="border-right: 1px solid #fff; padding-left: 8px;"> Attach </th>
                      <td mat-cell *matCellDef="let row" class="w-9 text-center" style="padding-left: 8px;">
                        <img *ngIf="row.IsAttachmentsAvailable == 1" src="./assets/images/icon-attachment.svg"></td>
                    </ng-container>

                    <ng-container matColumnDef="Status">
                      <th mat-header-cell mat-sort-header="Status" *matHeaderCellDef class="w-9 text-center" style="border-right: 1px solid #fff; padding-left: 44px;"> Status </th>
                      <td mat-cell *matCellDef="let row" class="w-9 text-center" style="padding-left: 14px;">
                        <span class="statusID" [ngClass]="row.StatusID == 1? 'draft' : 'ongoing'" style="cursor: auto !important;">{{row.Status}}</span></td>
                    </ng-container>

                    <ng-container matColumnDef="Action">
                      <th mat-header-cell *matHeaderCellDef class="w-10 text-center" style="border-right: 1px solid #fff; padding-left: 8px;"> </th>
                      <td mat-cell *matCellDef="let row" class="w-10 text-center" style="padding-left: 28px;">
                        <div class="w-80 mx-auto text-start">
                          <button mat-icon-button class="example-icon custom-button" matTooltip="Edit" (click)="addEditMessage('Edit', row)" [id]="'update' + row.CommunicationID"
                          *ngIf="(service.isBCManager || service.isFBCCUser) && row.StatusID == 1"> <img src="./assets/images/icon-edit.svg" class="m-0">
                        </button>
                          <button mat-icon-button class="example-icon custom-button" matTooltip="send communication" [id]="'crisisDetails' + row.CommunicationID" *ngIf="service.isBCManager && row.StatusID == 1"
                          (click)="directToCrisisCommDetails(row)"><img src="./assets/images/icon-right-arrow.svg"></button>
                        </div>
                      </td>
                    </ng-container>

                    <tr mat-header-row *matHeaderRowDef="displayedColumns; sticky: true" class="table-bg-header-color"></tr>
                    <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
                    <tr *matNoDataRow><td [attr.colspan]="displayedColumns.length">No data found.</td></tr>
                  </table>
                </section>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
